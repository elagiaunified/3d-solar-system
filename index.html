<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solar System Explorer</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      overflow: hidden;
    }
    
    .tooltip {
      transition: opacity 0.2s;
    }
  </style>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full relative overflow-hidden">
   <canvas id="spaceCanvas" class="absolute inset-0 w-full h-full"></canvas>
   <div class="absolute inset-0"><!-- Header -->
    <div class="p-6 pointer-events-auto">
     <h1 id="titleText" class="text-4xl font-bold mb-2">Solar System Explorer</h1>
     <p id="subtitleText" class="text-xl opacity-90">Complete Interactive 3D Solar System with Physics &amp; Educational Tools</p>
    </div><!-- Main Control Panel -->
    <div class="absolute top-6 right-6 p-4 rounded-lg pointer-events-auto max-w-xs" style="backdrop-filter: blur(10px);">
     <h3 class="text-sm font-bold mb-3 opacity-90">â±ï¸ TIME CONTROLS</h3>
     <div class="space-y-2 mb-4">
      <div class="flex items-center justify-between"><span class="text-xs opacity-80">Speed:</span> <span id="speedDisplay" class="text-xs font-bold">1.0x</span>
      </div><input type="range" id="speedSlider" min="0" max="50" value="10" class="w-full">
      <div class="flex gap-2"><button id="pauseBtn" class="flex-1 px-3 py-1 rounded text-xs font-bold">â¸ï¸ Pause</button> <button id="resetBtn" class="flex-1 px-3 py-1 rounded text-xs font-bold">â†º Reset</button>
      </div>
     </div>
     <h3 class="text-sm font-bold mb-3 opacity-90 border-t border-current border-opacity-20 pt-3">ğŸ”§ TOOLS</h3>
     <div class="space-y-2 mb-4"><button id="measureBtn" class="w-full px-3 py-1.5 rounded text-xs font-bold text-left">ğŸ“ Distance Measure</button> <button id="lagrangeBtn" class="w-full px-3 py-1.5 rounded text-xs font-bold text-left">ğŸ¯ Lagrange Points</button> <button id="habitableBtn" class="w-full px-3 py-1.5 rounded text-xs font-bold text-left">ğŸŒ¡ï¸ Habitable Zone</button> <button id="gravityBtn" class="w-full px-3 py-1.5 rounded text-xs font-bold text-left">âš¡ Gravity Wells</button> <button id="quizBtn" class="w-full px-3 py-1.5 rounded text-xs font-bold text-left">ğŸ“ Quiz Challenge</button>
     </div>
     <h3 class="text-sm font-bold mb-2 opacity-90 border-t border-current border-opacity-20 pt-3">ğŸ® CONTROLS</h3>
     <div class="space-y-1 text-xs opacity-80">
      <div>
       ğŸ–±ï¸ Drag to rotate
      </div>
      <div>
       ğŸ” Scroll to zoom
      </div>
      <div>
       ğŸ–±ï¸ Click planets for info
      </div>
     </div>
    </div><!-- Info Panel -->
    <div id="infoPanel" class="absolute bottom-6 left-6 p-4 rounded-lg max-w-md pointer-events-auto opacity-0 transition-opacity duration-300" style="backdrop-filter: blur(10px); max-height: 70%; overflow-y: auto;">
     <div class="flex justify-between items-start mb-2">
      <h3 id="objectName" class="text-xl font-bold"></h3><button id="closeInfo" class="text-xl opacity-60 hover:opacity-100">Ã—</button>
     </div>
     <p id="objectDescription" class="text-sm opacity-90 mb-3"></p>
     <div class="space-y-2 text-xs">
      <div class="p-2 rounded" style="background: rgba(255,255,255,0.05);">
       <div class="font-bold mb-1">
        ğŸ“Š Orbital Data
       </div>
       <div class="opacity-80">
        <strong>Distance from Sun:</strong> <span id="distanceInfo"></span>
       </div>
       <div class="opacity-80">
        <strong>Orbital Period:</strong> <span id="periodInfo"></span>
       </div>
       <div class="opacity-80">
        <strong>Orbital Velocity:</strong> <span id="velocityInfo"></span>
       </div>
      </div>
      <div class="p-2 rounded" style="background: rgba(255,255,255,0.05);">
       <div class="font-bold mb-1">
        ğŸŒ Physical Properties
       </div>
       <div class="opacity-80">
        <strong>Diameter:</strong> <span id="sizeInfo"></span>
       </div>
       <div class="opacity-80">
        <strong>Mass:</strong> <span id="massInfo"></span>
       </div>
       <div class="opacity-80">
        <strong>Gravity:</strong> <span id="gravityInfo"></span>
       </div>
      </div>
      <div class="p-2 rounded" style="background: rgba(255,255,255,0.05);">
       <div class="font-bold mb-1">
        ğŸ”¬ Composition
       </div>
       <div class="opacity-80" id="compositionInfo"></div>
      </div>
      <div class="p-2 rounded" style="background: rgba(255,255,255,0.05);">
       <div class="font-bold mb-1">
        ğŸš€ Travel Time from Earth
       </div>
       <div class="opacity-80" id="travelInfo"></div>
      </div>
     </div>
    </div><!-- Measurement Display -->
    <div id="measureDisplay" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-3 rounded-lg pointer-events-none opacity-0 transition-opacity" style="backdrop-filter: blur(10px);">
     <div class="text-center">
      <div class="text-xs opacity-80 mb-1">
       Distance
      </div>
      <div id="measureValue" class="text-2xl font-bold"></div>
      <div class="text-xs opacity-80 mt-1">
       Click two objects to measure
      </div>
     </div>
    </div><!-- Quiz Modal -->
    <div id="quizModal" class="absolute inset-0 flex items-center justify-center pointer-events-none opacity-0 transition-opacity" style="background: rgba(0,0,0,0.7);">
     <div class="p-6 rounded-lg max-w-lg pointer-events-auto" style="backdrop-filter: blur(10px);">
      <div class="flex justify-between items-start mb-4">
       <h2 class="text-2xl font-bold">ğŸ“ Solar System Quiz</h2><button id="closeQuiz" class="text-2xl opacity-60 hover:opacity-100">Ã—</button>
      </div>
      <div id="quizContent" class="space-y-4">
       <div class="text-lg mb-4" id="quizQuestion"></div>
       <div id="quizOptions" class="space-y-2"></div>
       <div id="quizFeedback" class="mt-4 p-3 rounded text-sm"></div>
       <div class="flex justify-between items-center mt-4">
        <div class="text-sm opacity-80">
         Score: <span id="quizScore">0</span>/5
        </div><button id="nextQuiz" class="px-4 py-2 rounded font-bold">Next Question</button>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
  const canvas = document.getElementById('spaceCanvas');
const ctx = canvas.getContext('2d');

// Set initial dimensions and variables
let width = window.innerWidth;
let height = window.innerHeight;
let centerX = width / 2;
let centerY = height / 2;
let rotation = { x: 0, y: 0 };
let zoom = 1.5; // Increased initial zoom so planets are visible
let isDragging = false;
let lastMouseX = 0;
let lastMouseY = 0;
let isPaused = false;
let timeSpeed = 1;
let time = 0;
let selectedObject = null;

// Tool states
let showLagrange = false;
let showHabitable = false;
let showGravity = false;
let measureMode = false;
let measurePoint1 = null;
let measurePoint2 = null;

// Quiz state
let currentQuestion = 0;
let quizScore = 0;

// Set canvas size
canvas.width = width;
canvas.height = height;

// Simple celestial bodies with basic properties
const celestialBodies = {
  sun: {
    name: "Sun", radius: 40, color: "#FFD700", distance: 0, period: 0, angle: 0,
    description: "The star at the center of our solar system.",
    distanceText: "0 AU", periodText: "N/A", velocity: "N/A",
    diameter: "1,391,000 km", mass: "1.989 Ã— 10Â³â° kg", gravity: "274 m/sÂ²"
  },
  mercury: {
    name: "Mercury", radius: 8, color: "#B8B8B8", distance: 100, period: 88, angle: 0,
    description: "Smallest planet and closest to the Sun.",
    distanceText: "0.39 AU (58M km)", periodText: "88 days", velocity: "47.4 km/s",
    diameter: "4,879 km", mass: "3.3 Ã— 10Â²Â³ kg", gravity: "3.7 m/sÂ²"
  },
  venus: {
    name: "Venus", radius: 15, color: "#FFC649", distance: 150, period: 225, angle: 1,
    description: "Hottest planet with a thick toxic atmosphere.",
    distanceText: "0.72 AU (108M km)", periodText: "225 days", velocity: "35.0 km/s",
    diameter: "12,104 km", mass: "4.87 Ã— 10Â²â´ kg", gravity: "8.9 m/sÂ²"
  },
  earth: {
    name: "Earth", radius: 16, color: "#6B9BD1", distance: 200, period: 365, angle: 2,
    description: "Our home planet. Only known world with life.",
    distanceText: "1.0 AU (150M km)", periodText: "365.25 days", velocity: "29.8 km/s",
    diameter: "12,742 km", mass: "5.97 Ã— 10Â²â´ kg", gravity: "9.8 m/sÂ²"
  },
  mars: {
    name: "Mars", radius: 12, color: "#E27B58", distance: 260, period: 687, angle: 3,
    description: "The Red Planet with the largest volcano in the solar system.",
    distanceText: "1.52 AU (228M km)", periodText: "687 days", velocity: "24.1 km/s",
    diameter: "6,779 km", mass: "6.42 Ã— 10Â²Â³ kg", gravity: "3.7 m/sÂ²"
  },
  jupiter: {
    name: "Jupiter", radius: 35, color: "#E8B882", distance: 340, period: 4333, angle: 4,
    description: "Largest planet with a mass greater than all other planets combined.",
    distanceText: "5.2 AU (778M km)", periodText: "11.9 years", velocity: "13.1 km/s",
    diameter: "139,820 km", mass: "1.90 Ã— 10Â²â· kg", gravity: "24.8 m/sÂ²"
  },
  saturn: {
    name: "Saturn", radius: 30, color: "#F4E8C1", distance: 420, period: 10759, angle: 5,
    description: "Famous for its spectacular ring system.",
    distanceText: "9.5 AU (1.4B km)", periodText: "29.5 years", velocity: "9.7 km/s",
    diameter: "116,460 km", mass: "5.68 Ã— 10Â²â¶ kg", gravity: "10.4 m/sÂ²"
  }
};

function resizeCanvas() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
  centerX = width / 2;
  centerY = height / 2;
}

function drawPlanet(x, y, radius, color) {
  // Draw glow effect
  const gradient = ctx.createRadialGradient(
    x, y, 0,
    x, y, radius * zoom
  );
  gradient.addColorStop(0, color);
  gradient.addColorStop(1, color + "80");
  
  ctx.fillStyle = gradient;
  ctx.beginPath();
  ctx.arc(x, y, radius * zoom, 0, Math.PI * 2);
  ctx.fill();
  
  // Draw border
  ctx.strokeStyle = "#FFFFFF";
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.arc(x, y, radius * zoom, 0, Math.PI * 2);
  ctx.stroke();
}

function drawOrbit(distance) {
  ctx.strokeStyle = "rgba(255, 255, 255, 0.2)";
  ctx.lineWidth = 1;
  ctx.setLineDash([5, 5]);
  ctx.beginPath();
  ctx.arc(centerX, centerY, distance * zoom, 0, Math.PI * 2);
  ctx.stroke();
  ctx.setLineDash([]);
}

function getPosition(body) {
  const angle = body.angle + rotation.y;
  return {
    x: centerX + Math.cos(angle) * body.distance * zoom,
    y: centerY + Math.sin(angle) * body.distance * zoom
  };
}

function drawGravityWells() {
  Object.entries(celestialBodies).forEach(([key, body]) => {
    const pos = getPosition(body);
    const gravityRadius = body.radius * 3;
    
    const gradient = ctx.createRadialGradient(
      pos.x, pos.y, body.radius * zoom,
      pos.x, pos.y, gravityRadius * zoom
    );
    gradient.addColorStop(0, body.color + "40");
    gradient.addColorStop(1, body.color + "00");
    
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(pos.x, pos.y, gravityRadius * zoom, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawHabitableZone() {
  const inner = 180 * zoom;
  const outer = 220 * zoom;
  
  const gradient = ctx.createRadialGradient(centerX, centerY, inner, centerX, centerY, outer);
  gradient.addColorStop(0, 'rgba(50, 205, 50, 0.1)');
  gradient.addColorStop(1, 'rgba(50, 205, 50, 0)');
  
  ctx.fillStyle = gradient;
  ctx.beginPath();
  ctx.arc(centerX, centerY, outer, 0, Math.PI * 2);
  ctx.arc(centerX, centerY, inner, 0, Math.PI * 2, true);
  ctx.fill();
  
  ctx.strokeStyle = 'rgba(50, 205, 50, 0.6)';
  ctx.lineWidth = 2;
  ctx.setLineDash([10, 5]);
  ctx.beginPath();
  ctx.arc(centerX, centerY, inner, 0, Math.PI * 2);
  ctx.stroke();
  ctx.beginPath();
  ctx.arc(centerX, centerY, outer, 0, Math.PI * 2);
  ctx.stroke();
  ctx.setLineDash([]);
}

function render() {
  // Clear canvas with dark blue background
  ctx.fillStyle = "#0A0E27";
  ctx.fillRect(0, 0, width, height);
  
  // Draw orbits
  Object.values(celestialBodies).forEach(body => {
    if (body.distance > 0) {
      drawOrbit(body.distance);
    }
  });
  
  // Draw habitable zone if active
  if (showHabitable) {
    drawHabitableZone();
  }
  
  // Draw gravity wells if active
  if (showGravity) {
    drawGravityWells();
  }
  
  // Draw planets
  Object.entries(celestialBodies).forEach(([key, body]) => {
    const pos = getPosition(body);
    drawPlanet(pos.x, pos.y, body.radius, body.color);
    
    // Highlight selected planet
    if (key === selectedObject) {
      ctx.strokeStyle = "#4A90E2";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.arc(pos.x, pos.y, (body.radius + 5) * zoom, 0, Math.PI * 2);
      ctx.stroke();
    }
  });
}

function animate() {
  if (!isPaused) {
    time += 0.0005 * timeSpeed;
    
    // Update planet positions
    Object.values(celestialBodies).forEach(body => {
      if (body.period > 0) {
        body.angle = time * (2 * Math.PI / body.period) * 50;
      }
    });
  }
  
  render();
  requestAnimationFrame(animate);
}

// Event Listeners
canvas.addEventListener('mousedown', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;
  
  // Find clicked planet
  let clickedPlanet = null;
  let minDistance = Infinity;
  
  Object.entries(celestialBodies).forEach(([key, body]) => {
    const pos = getPosition(body);
    const distance = Math.sqrt(
      Math.pow(mouseX - pos.x, 2) + 
      Math.pow(mouseY - pos.y, 2)
    );
    
    if (distance < body.radius * zoom + 10 && distance < minDistance) {
      minDistance = distance;
      clickedPlanet = key;
    }
  });
  
  if (clickedPlanet) {
    selectedObject = clickedPlanet;
    const body = celestialBodies[clickedPlanet];
    
    // Update info panel
    document.getElementById('objectName').textContent = body.name;
    document.getElementById('objectDescription').textContent = body.description;
    document.getElementById('distanceInfo').textContent = body.distanceText;
    document.getElementById('periodInfo').textContent = body.periodText;
    document.getElementById('velocityInfo').textContent = body.velocity;
    document.getElementById('sizeInfo').textContent = body.diameter;
    document.getElementById('massInfo').textContent = body.mass;
    document.getElementById('gravityInfo').textContent = body.gravity;
    
    document.getElementById('infoPanel').style.opacity = '1';
  }
  
  // Start dragging
  isDragging = true;
  lastMouseX = e.clientX;
  lastMouseY = e.clientY;
  e.preventDefault();
});

canvas.addEventListener('mousemove', (e) => {
  if (isDragging) {
    const deltaX = e.clientX - lastMouseX;
    const deltaY = e.clientY - lastMouseY;
    
    rotation.y += deltaX * 0.01;
    rotation.x += deltaY * 0.01;
    
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
  }
});

canvas.addEventListener('mouseup', () => {
  isDragging = false;
});

canvas.addEventListener('mouseleave', () => {
  isDragging = false;
});

canvas.addEventListener('wheel', (e) => {
  e.preventDefault();
  zoom += e.deltaY * -0.001;
  zoom = Math.max(0.3, Math.min(3, zoom));
});

// Control panel event listeners
document.getElementById('speedSlider').addEventListener('input', (e) => {
  timeSpeed = parseFloat(e.target.value) / 10;
  document.getElementById('speedDisplay').textContent = timeSpeed.toFixed(1) + 'x';
});

document.getElementById('pauseBtn').addEventListener('click', () => {
  isPaused = !isPaused;
  document.getElementById('pauseBtn').textContent = isPaused ? 'â–¶ï¸ Resume' : 'â¸ï¸ Pause';
});

document.getElementById('resetBtn').addEventListener('click', () => {
  time = 0;
  rotation = { x: 0, y: 0 };
  zoom = 1.5;
  Object.entries(celestialBodies).forEach(([key, body]) => {
    body.angle = 0;
  });
});

// Tool buttons
document.getElementById('gravityBtn').addEventListener('click', () => {
  showGravity = !showGravity;
  const btn = document.getElementById('gravityBtn');
  btn.style.background = showGravity ? '#4A90E2' : '';
  btn.style.color = showGravity ? 'white' : '';
});

document.getElementById('habitableBtn').addEventListener('click', () => {
  showHabitable = !showHabitable;
  const btn = document.getElementById('habitableBtn');
  btn.style.background = showHabitable ? '#4A90E2' : '';
  btn.style.color = showHabitable ? 'white' : '';
});

document.getElementById('lagrangeBtn').addEventListener('click', () => {
  alert('Lagrange Points feature will be implemented soon!');
});

document.getElementById('measureBtn').addEventListener('click', () => {
  alert('Distance Measurement feature will be implemented soon!');
});

document.getElementById('quizBtn').addEventListener('click', () => {
  alert('Quiz feature will be implemented soon!');
});

// Close buttons
document.getElementById('closeInfo').addEventListener('click', () => {
  document.getElementById('infoPanel').style.opacity = '0';
});

// Initialize
resizeCanvas();
animate();

// Handle window resize
window.addEventListener('resize', resizeCanvas);

// Apply initial styles
document.addEventListener('DOMContentLoaded', () => {
  // Set dark theme
  document.body.style.backgroundColor = '#0A0E27';
  document.body.style.color = '#E8E8F0';
  
  // Style control panels
  const panels = document.querySelectorAll('[style*="backdrop-filter"]');
  panels.forEach(panel => {
    panel.style.backgroundColor = 'rgba(26, 31, 58, 0.9)';
  });
  
  // Style buttons
  const buttons = document.querySelectorAll('button');
  buttons.forEach(btn => {
    if (!btn.id.includes('measure') && !btn.id.includes('lagrange') && 
        !btn.id.includes('habitable') && !btn.id.includes('gravity')) {
      btn.style.backgroundColor = '#4A90E2';
      btn.style.color = 'white';
      btn.style.border = 'none';
      btn.style.padding = '8px 12px';
      btn.style.borderRadius = '4px';
      btn.style.cursor = 'pointer';
    }
  });
  
  // Style info panel
  const infoPanel = document.getElementById('infoPanel');
  infoPanel.style.backgroundColor = 'rgba(26, 31, 58, 0.9)';
  infoPanel.style.border = '1px solid rgba(255, 255, 255, 0.1)';
});
  </script>
